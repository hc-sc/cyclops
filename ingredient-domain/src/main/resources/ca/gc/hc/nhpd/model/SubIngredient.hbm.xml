<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD 3.6//EN"
	"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">

<hibernate-mapping package="ca.gc.hc.nhpd.model">
  <class name="SubIngredient" table="subingredients" lazy="false">
    <cache usage="read-write"/>
    <id name="id" type="java.lang.Long" column="subingred_id">
	 		<generator class="sequence">
	        	<param name="sequence">subingredients_seq</param>
	        </generator>
    </id>
    <property name="mandatory" type="yes_no" column="subingred_mandatory_flag" not-null="true"/>
    <many-to-one name="ingredient" column="ingred_id" not-null="true"/>
    <many-to-one name="units" column="units_id" not-null="false"/>
    <property name="lowerYield" type="java.lang.Double" column="subingred_lower_yield"/>
    <property name="upperYield" type="java.lang.Double" column="subingred_upper_yield"/>
	
	<set name="dosageForms" sort="natural" table="subingredient_dosage_forms">
        <cache usage="read-write"/>
		<key column="subingred_id"/>
		<many-to-many column="dosefrm_id" class="DosageForm"/>
	</set>
    <set name="references" sort="natural" table="subingredient_refs">
        <cache usage="read-write"/>
        <key column="subingred_id"/>
        <many-to-many column="ref_id" class="Reference"/>
    </set>  
	<set name="routesOfAdministration" sort="natural" table="subingredient_admin_routes">
        <cache usage="read-write"/>
		<key column="subingred_id"/>
		<many-to-many column="adminrt_id" class="RouteOfAdministration"/>
	</set>

	<property name="commentE" type="string" length="1000" column="subingred_comment_eng"/>
	<property name="commentF" type="string" length="1000" column="subingred_comment_fr"/>

    <property name="creationDate" type="date" column="subingred_creation_date"/>
	<property name="lastUpdateDate" type="date" column="subingred_lastupdate_date"/>
	<many-to-one name="lastUpdateAccount" column="useracc_id" not-null="true"/>
    
	<join table="ingredient_subingredients" optional="true">
		<key column="subingred_id" unique="true"/>
		<many-to-one name="parentIngredient" column="ingred_id" not-null="false"/>
	</join>
	<join table="organism_part_subingredients" optional="true">
		<key column="subingred_id" unique="true"/>
		<many-to-one name="parentOrganismPart" column="orgpart_id" not-null="false"/>
	</join>	
	
  </class>
</hibernate-mapping>